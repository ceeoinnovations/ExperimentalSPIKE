<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pyscript Demo 3</title>
    <link rel="stylesheet" href="./style2.css" />
    <link rel="stylesheet" href="https://pyscript.net/alpha/pyscript.css" />
    <script defer src="https://pyscript.net/alpha/pyscript.js"></script>
    <py-env>
        - numpy
        - matplotlib
        - scikit-learn
    </py-env>
</head>

<body>
    <py-title>Sklearn Two Moons Example (Pt 2)</py-title>
    <p>This demo attempts to solve the same problem as in demo 3, but uses KPCA instead of spectral clustering.</p>
    <br>

    <py-script>
        import numpy as np
        import matplotlib.pyplot as plt
        from sklearn.decomposition import KernelPCA

        print("Unclassified Data v. Data Classified with Kernel PCA")

        moon = np.array([[-0.046914187,1.031403902,],
        [0.273721525,-0.161737019,],
        [0.493076808,0.797365636,],
        [1.016272746,-0.575625742,],
        [0.857462734,0.63381196,],
        [-0.182886635,0.189006904,],
        [1.842653663,0.058065451,],
        [-0.094890788,0.913765681,],
        [1.332440651,-0.318192336,],
        [1.275917403,-0.447736918,],
        [-0.703888382,0.55903062,],
        [1.874210947,-0.03298491,],
        [2.020115757,-0.210923065,],
        [1.926003166,0.157518434,],
        [0.018077978,0.384883768,],
        [0.628027391,0.841421706,],
        [0.856615181,0.164433334,],
        [1.704964437,0.027755094,],
        [0.211192829,-0.117173727,],
        [0.77427079,0.60191353,],
        [1.636349446,-0.088466169,],
        [-0.927992952,0.238226251,],
        [1.519380153,-0.42077052,],
        [1.514897301,-0.278920321,],
        [0.47195774,-0.149042515,],
        [-0.920592204,0.82284026,],
        [1.781941977,0.068949091,],
        [0.544639883,0.726613588,],
        [0.915361249,-0.53083607,],
        [-0.112915563,0.869412987,],
        [-0.81314729,0.504335343,],
        [-1.180611641,0.191614501,],
        [1.852912587,-0.018549393,],
        [0.171119943,-0.079060825,],
        [-0.89980722,0.467741896,],
        [0.530410761,-0.366965171,],
        [1.810074748,0.017377929,],
        [0.726970738,-0.449446566,],
        [-0.881415386,0.068102579,],
        [0.643808956,-0.394190267,],
        [0.897593553,0.644411082,],
        [0.888288243,-0.536818913,],
        [0.105253088,0.095571054,],
        [0.501552318,0.69131813,],
        [0.682112273,0.534374902,],
        [1.604579292,-0.294972971,],
        [0.190457828,0.861851955,],
        [-0.139100351,0.585484186,],
        [1.134697197,-0.716577019,],
        [-0.597698726,0.66217995,],
        [2.006898221,-0.04314612,],
        [0.089040534,0.257137753,],
        [0.227468655,1.025969643,],
        [0.16063485,-0.004647302,],
        [1.944893719,0.253451825,],
        [1.349426602,-0.445430373,],
        [0.917629979,0.401236926,],
        [1.958081312,-0.05257446,],
        [-0.727796812,0.49724573,],
        [-0.513484983,1.023781412,],
        [-0.970418935,0.316587235,],
        [0.038612444,0.3490792,],
        [0.079535724,0.19156318,],
        [0.840846106,-0.4898024,],
        [1.046802978,0.247622515,],
        [0.874259752,-0.625488329,],
        [1.165905785,-0.435031206,],
        [-0.937773891,0.363379481,],
        [0.360304217,1.014170488,],
        [-0.532754907,0.7493436,],
        [0.562402299,0.908995296,],
        [0.890200371,0.470841904,],
        [1.15925753,-0.372947691,],
        [-0.884937765,0.457053245,],
        [1.281126104,-0.513321053,],
        [0.229540599,1.070744511,],
        [1.966581908,0.332160511,],
        [1.187559309,-0.503931961,],
        [0.340675004,-0.359031851,],
        [-0.306714971,0.864362948,],
        [1.069558334,0.02232741,],
        [0.638074748,0.713346777,],
        [1.69578178,-0.232839274,],
        [0.512828983,-0.18762429,],
        [0.657839723,0.595093212,],
        [0.499312111,0.921997041,],
        [0.853864883,0.044124332,],
        [2.021193713,0.230364194,],
        [0.195123314,0.940468285,],
        [0.763854539,-0.441179886,],
        [0.222909221,0.838849373,],
        [-0.283767471,0.992715074,],
        [0.993567924,-0.391371275,],
        [0.096606419,0.850266326,],
        [0.356195146,-0.110897708,],
        [1.034443502,0.14179547,],
        [0.697733278,0.479445918,],
        [1.46024503,-0.372371177,],
        [-0.613189731,0.842071173,],
        [-0.716551915,0.831902755,],
        [-0.32649567,0.918689169,],
        [2.051202948,0.346561214,],
        [0.074939385,0.852711487,],
        [0.695170249,0.740671681,],
        [-0.294348772,1.126243082,],
        [0.667929988,-0.430309415,],
        [0.909129135,-0.60379305,],
        [1.844174918,0.072263445,],
        [1.43554901,-0.418713993,],
        [0.708728436,-0.372729499,],
        [-0.754274508,0.269678402,],
        [0.808909171,0.22318325,],
        [0.961833524,0.153773098,],
        [1.259552972,-0.597214666,],
        [0.151876367,-0.067790301,],
        [0.029738442,-0.29846344,],
        [1.566473924,-0.414193676,],
        [2.014218659,0.226876703,],
        [1.49643186,-0.233919088,],
        [0.778809368,-0.447319076,],
        [-0.956220975,0.391952493,],
        [0.860964679,0.399874364,],
        [0.978635478,0.433882723,],
        [-0.453198966,0.777737123,],
        [0.982398933,0.080773381,],
        [-1.054014919,0.460419922,],
        [1.456489903,-0.199984716,],
        [-0.956353288,0.21461902,],
        [0.56207881,-0.424442125,],
        [0.177565194,1.081824688,],
        [0.106624155,0.0003892,],
        [-0.090506914,0.818350565,],
        [1.087359138,-0.02851312,],
        [0.870918747,0.44309124,],
        [0.912783019,0.44903189,],
        [1.664448913,-0.097928825,],
        [-0.0987811,0.94632176,],
        [0.425325291,0.699645926,],
        [0.052892852,0.44384578,],
        [0.345399123,0.986952153,],
        [0.290311771,-0.423509862,],
        [-0.124057031,0.613293417,],
        [0.88717268,0.496362753,],
        [0.762967828,-0.426061624,],
        [0.09400549,0.017137053,],
        [1.912988236,0.456196167,],
        [-0.512195213,0.723577824,],
        [0.836318137,0.46080615,],
        [0.893152362,-0.477236502,],
        [0.783240809,0.595727387,],
        [0.545691856,-0.466672212,],
        [-0.099535584,1.010645297,],
        [-0.840125389,0.76896493,],
        [-0.185228164,1.066884524,],
        [-0.66832897,0.951144265,],
        [2.033923656,0.431764783,],
        [0.451556172,-0.386964399,],
        [-0.724955918,0.775536952,],
        [0.476480598,0.7499422,],
        [1.129974806,-0.456026423,],
        [-1.029516515,0.198127832,],
        [-0.070727336,0.027798712,],
        [-0.923644746,-0.063330986,],
        [0.108148453,0.44418536,],
        [-1.028911856,0.222693625,],
        [0.311650725,-0.232741053,],
        [-1.290004921,-0.040037098,],
        [-0.103264445,0.244389813,],
        [0.548932212,-0.347333186,],
        [1.960124614,0.210643193,],
        [1.68426185,-0.221330734,],
        [2.0602719,0.518169561,],
        [0.480639538,1.019348845,],
        [-0.742890357,0.466260988,],
        [0.976217194,-0.097128645,],
        [-0.37403439,0.85079286,],
        [0.023006114,0.894858157,],
        [-0.357668342,0.768008542,],
        [1.914474125,0.222975848,],
        [1.435132443,-0.290624071,],
        [-0.860158035,0.836063493,],
        [1.929928252,0.212796931,],
        [1.141010017,-0.56560775,],
        [0.049287987,0.01964579,],
        [1.654792995,-0.293410284,],
        [0.553146014,1.012306399,],
        [-0.517153325,0.622423441,],
        [-0.055936286,1.112003797,],
        [1.985850525,0.336454315,],
        [0.003773053,-0.031786315,],
        [-1.000659413,0.155677202,],
        [-0.347124568,1.097539979,],
        [0.242497921,-0.163694993,],
        [0.084920216,0.249848959,],
        [-0.886698961,0.591054005,],
        [0.720171979,0.431592141,],
        [-1.044341781,-0.019588168,],
        [-0.379575161,0.9368029,],
        [0.277855477,-0.194371516,],
        [0.205228094,0.386371976,]], dtype=float)



        fig, ax = plt.subplots(2)
        fig.set_figheight(6)
        fig.set_figwidth(5)

        ax[0].scatter(moon[:,0], moon[:,1], label="dots", color="g", marker=".", s=10)

        transformer = KernelPCA(kernel='rbf')
        transformedData = transformer.fit_transform(moon)

        redPts, bluePts = np.zeros([moon[:,0].size, 2]), np.zeros([moon[:,0].size, 2])
        numReds, numBlues = 0, 0
        totalPts = moon[:,0].size

        '''
        for i in range(totalPts):
            if (clustering.labels_[i] == 0):
                redPts[numReds] = moon[i]
                numReds += 1
            else:
                bluePts[numBlues] = moon[i]
                numBlues += 1

        redPts = np.delete(redPts, np.s_[numReds:], 0)
        bluePts = np.delete(bluePts, np.s_[numBlues:], 0)

        ax[1].scatter(redPts[:,0], redPts[:,1], label="dots", color='r', marker=".", s=10)
        ax[1].scatter(bluePts[:,0], bluePts[:,1], label="dots", color='b', marker=".", s=10)
        plt
        '''
        
    </py-script>


</body>